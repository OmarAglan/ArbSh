# Project Organization (C# Refactoring)

## Overview

This document outlines the organization structure for the **ArbSh project during its refactoring to C#/.NET**. The original C project structure remains temporarily for reference during the porting process. The goal is to create a maintainable, scalable, and well-documented C# codebase for a PowerShell-inspired shell with first-class Arabic support.

## Current Directory Structure

```
arbsh/
├── .git/               # Git repository data
├── .github/            # GitHub specific files (workflows, etc.)
├── .vscode/            # VS Code settings (optional)
├── docs/               # Documentation (including this file)
│   ├── *.md            # Markdown documentation files
├── src_csharp/         # NEW: Root for all C#/.NET code
│   ├── ArbSh.sln       # .NET Solution file
│   └── ArbSh.Console/  # Main C# Console Application project
│       ├── ArbSh.Console.csproj
│       ├── Program.cs
│       ├── PipelineObject.cs # Example core class
│       └── CmdletBase.cs     # Example core class
│   # (Future C# library projects for Core, Cmdlets, I18n_Ported, etc. will go here)
├── src/                # ORIGINAL C: Source code (preserved for reference)
│   ├── core/
│   ├── platform/
│   ├── i18n/           # Key reference for porting (BiDi, UTF-8, Locale)
│   └── utils/          # Key reference for porting
├── include/            # ORIGINAL C: Public header files (preserved for reference)
├── tests/              # ORIGINAL C: Test suite (preserved for reference)
│   ├── unit/
│   ├── integration/
│   ├── arabic/         # Key reference for porting tests
│   └── fixtures/
├── .editorconfig       # Editor configuration
├── .gitattributes      # Git attributes
├── .gitignore          # Git ignore rules (updated for C#)
├── README.md           # Main project README (updated for C#)
└── ROADMAP.md          # Project roadmap (updated for C#)

# Files to be removed/archived eventually:
# CMakeLists.txt
# cmake/
# build/ (if generated by CMake)
```

## Code Organization Principles (C# Focus)

While the C code is preserved for reference, the new C# codebase will adhere to standard .NET conventions and principles:

1.  **Namespaces:** Organize code logically using namespaces (e.g., `ArbSh.Core`, `ArbSh.Commands`, `ArbSh.I18n`).
2.  **Solution/Projects:** Structure the code into multiple projects within the `ArbSh.sln` solution for better modularity (e.g., a core library, a cmdlet library, the console host).
3.  **Separation of Concerns:**
    *   Isolate pipeline execution logic.
    *   Separate command parsing from execution.
    *   Keep cmdlet implementations distinct.
    *   Encapsulate ported i18n logic.
4.  **Naming Conventions:** Follow standard .NET naming guidelines (PascalCase for classes, methods, properties; camelCase for local variables).
5.  **Asynchronous Programming:** Utilize `async`/`await` where appropriate, especially for I/O operations and external process management.
6.  **Dependency Injection:** Consider using DI for managing dependencies between components, especially as the shell grows more complex.

## Build System

-   The project now uses the standard **.NET CLI build tools** (`dotnet build`, `dotnet run`, etc.) managed via the solution (`.sln`) and project (`.csproj`) files.
-   The CMake build system (`CMakeLists.txt`, `cmake/`) is **deprecated** and only relevant for potentially building the reference C code if needed. It will eventually be removed.

## Testing (C# Focus)

-   A new C# test suite needs to be developed using a .NET testing framework (e.g., xUnit, NUnit, MSTest).
-   Unit tests should cover:
    *   Core pipeline logic.
    *   Parser and command resolution.
    *   Individual cmdlets.
    *   **Crucially: The ported i18n/BiDi logic.**
-   Integration tests will be needed to verify end-to-end scenarios.

## Documentation

-   **Code Documentation:** Use XML documentation comments (`///`) in C# code for IntelliSense and potential automated documentation generation.
-   **Markdown Docs:** Continue using Markdown files in the `docs/` directory for conceptual documentation, design decisions, user guides, etc., ensuring they reflect the C# implementation.

## Role of Original C Code

-   The `src/`, `include/`, and `tests/` directories containing the original C code serve purely as a **reference** during the porting process.
-   Key areas for reference are `src/i18n/` (BiDi, locale, input), `src/utils/` (UTF-8, string manipulation), and `tests/arabic/`.
-   This code is **not** part of the active C# build process.
-   Once the relevant logic is successfully ported and tested in C#, these directories may be archived or removed.

## Conclusion

This revised organization reflects the shift to C#/.NET development. It establishes a clean structure for the new codebase while preserving the valuable logic from the original implementation as a reference for the critical porting effort, particularly for the complex Arabic language support features.
